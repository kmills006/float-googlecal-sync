var index_1 = require('./index');
var chai_1 = require('chai');
var http_1 = require('http');
describe('get headers', function () {
    it('should parse headers', function () {
        var headers = index_1.parse([
            'Content-Type: application/json',
            'Cookie: foo',
            'Cookie: bar',
            'Cookie: baz'
        ].join('\n'));
        chai_1.expect(headers).to.deep.equal({
            'Content-Type': 'application/json',
            'Cookie': ['foo', 'bar', 'baz']
        });
    });
    it('should use consistent header case', function () {
        var headers = index_1.parse([
            'cOOkIE: foo',
            'cookie: bar',
            'Cookie: baz'
        ].join('\n'));
        chai_1.expect(headers).to.deep.equal({
            'Cookie': ['foo', 'bar', 'baz']
        });
    });
    it('should parse http', function (done) {
        var server = http_1.createServer(function (req, res) {
            res.setHeader('Content-Type', 'application/json');
            res.setHeader('Cookie', ['foo', 'bar', 'baz']);
            res.end('hello world');
        });
        server.on('listening', function () {
            http_1.get('http://localhost:' + server.address().port, function (res) {
                var headers = index_1.http(res);
                if (res.rawHeaders) {
                    chai_1.expect(headers['Content-Type']).to.equal('application/json');
                    chai_1.expect(headers['Cookie']).to.deep.equal(['foo', 'bar', 'baz']);
                }
                else {
                    chai_1.expect(headers['content-type']).to.equal('application/json');
                    chai_1.expect(headers['cookie']).to.deep.equal('foo, bar, baz');
                }
                server.close();
                return done();
            });
        });
        server.listen(0);
    });
});
//# sourceMappingURL=index.spec.js.map